"use strict";var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message
},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};sjcl.cipher.aes=function(t){
this._tables[0][0][0]||this._precompute();var e,i,r,s,n,c=this._tables[0][4],o=this._tables[1],a=t.length,l=1;if(4!==a&&6!==a&&8!==a)throw new sjcl.exception.invalid("invalid aes key size");for(this._key=[s=t.slice(0),n=[]],e=a;e<4*a+28;e++)r=s[e-1],
(e%a==0||8===a&&e%a==4)&&(r=c[r>>>24]<<24^c[r>>16&255]<<16^c[r>>8&255]<<8^c[255&r],e%a==0&&(r=r<<8^r>>>24^l<<24,l=l<<1^283*(l>>7))),s[e]=s[e-a]^r;for(i=0;e;i++,e--)r=s[3&i?e:e-4],
n[i]=e<=4||i<4?r:o[0][c[r>>>24]]^o[1][c[r>>16&255]]^o[2][c[r>>8&255]]^o[3][c[255&r]]},sjcl.cipher.aes.prototype={encrypt:function(t){return this._crypt(t,0)},decrypt:function(t){return this._crypt(t,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],
_precompute:function(){var t,e,i,r,s,n,c,o,a=this._tables[0],l=this._tables[1],h=a[4],f=l[4],u=[],d=[];for(t=0;t<256;t++)d[(u[t]=t<<1^283*(t>>7))^t]=t;for(e=i=0;!h[e];e^=r||1,i=d[i]||1)for(n=(n=i^i<<1^i<<2^i<<3^i<<4)>>8^255&n^99,h[e]=n,f[n]=e,
o=16843009*u[s=u[r=u[e]]]^65537*s^257*r^16843008*e,c=257*u[n]^16843008*n,t=0;t<4;t++)a[t][e]=c=c<<24^c>>>8,l[t][n]=o=o<<24^o>>>8;for(t=0;t<5;t++)a[t]=a[t].slice(0),l[t]=l[t].slice(0)},_crypt:function(t,e){
if(4!==t.length)throw new sjcl.exception.invalid("invalid aes block size");var i,r,s,n,c=this._key[e],o=t[0]^c[0],a=t[e?3:1]^c[1],l=t[2]^c[2],h=t[e?1:3]^c[3],f=c.length/4-2,u=4,d=[0,0,0,0],p=this._tables[e],b=p[0],m=p[1],A=p[2],B=p[3],F=p[4]
;for(n=0;n<f;n++)i=b[o>>>24]^m[a>>16&255]^A[l>>8&255]^B[255&h]^c[u],r=b[a>>>24]^m[l>>16&255]^A[h>>8&255]^B[255&o]^c[u+1],s=b[l>>>24]^m[h>>16&255]^A[o>>8&255]^B[255&a]^c[u+2],h=b[h>>>24]^m[o>>16&255]^A[a>>8&255]^B[255&l]^c[u+3],u+=4,o=i,a=r,l=s
;for(n=0;n<4;n++)d[e?3&-n:n]=F[o>>>24]<<24^F[a>>16&255]<<16^F[l>>8&255]<<8^F[255&h]^c[u++],i=o,o=a,a=l,l=h,h=i;return d}},sjcl.bitArray={bitSlice:function(t,e,i){return t=sjcl.bitArray._shiftRight(t.slice(e/32),32-(31&e)).slice(1),
void 0===i?t:sjcl.bitArray.clamp(t,i-e)},extract:function(t,e,i){var r=Math.floor(-e-i&31);return(-32&(e+i-1^e)?t[e/32|0]<<32-r^t[e/32+1|0]>>>r:t[e/32|0]>>>r)&(1<<i)-1},concat:function(t,e){if(0===t.length||0===e.length)return t.concat(e)
;var i=t[t.length-1],r=sjcl.bitArray.getPartial(i);return 32===r?t.concat(e):sjcl.bitArray._shiftRight(e,r,0|i,t.slice(0,t.length-1))},bitLength:function(t){var e,i=t.length;return 0===i?0:(e=t[i-1],32*(i-1)+sjcl.bitArray.getPartial(e))},clamp:function(t,e){
if(32*t.length<e)return t;var i=(t=t.slice(0,Math.ceil(e/32))).length;return e&=31,i>0&&e&&(t[i-1]=sjcl.bitArray.partial(e,t[i-1]&2147483648>>e-1,1)),t},partial:function(t,e,i){return 32===t?e:(i?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){
return Math.round(t/1099511627776)||32},equal:function(t,e){if(sjcl.bitArray.bitLength(t)!==sjcl.bitArray.bitLength(e))return!1;var i,r=0;for(i=0;i<t.length;i++)r|=t[i]^e[i];return 0===r},_shiftRight:function(t,e,i,r){var s,n,c=0
;for(void 0===r&&(r=[]);e>=32;e-=32)r.push(i),i=0;if(0===e)return r.concat(t);for(s=0;s<t.length;s++)r.push(i|t[s]>>>e),i=t[s]<<32-e;return c=t.length?t[t.length-1]:0,n=sjcl.bitArray.getPartial(c),r.push(sjcl.bitArray.partial(e+n&31,e+n>32?i:r.pop(),1)),r},
_xor4:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]},byteswapM:function(t){var e,i;for(e=0;e<t.length;++e)i=t[e],t[e]=i>>>24|i>>>8&65280|(65280&i)<<8|i<<24;return t}},sjcl.codec.utf8String={fromBits:function(t){
var e,i,r="",s=sjcl.bitArray.bitLength(t);for(e=0;e<s/8;e++)0==(3&e)&&(i=t[e/4]),r+=String.fromCharCode(i>>>8>>>8>>>8),i<<=8;return decodeURIComponent(escape(r))},toBits:function(t){t=unescape(encodeURIComponent(t));var e,i=[],r=0
;for(e=0;e<t.length;e++)r=r<<8|t.charCodeAt(e),3==(3&e)&&(i.push(r),r=0);return 3&e&&i.push(sjcl.bitArray.partial(8*(3&e),r)),i}},sjcl.codec.hex={fromBits:function(t){var e,i="";for(e=0;e<t.length;e++)i+=(0xf00000000000+(0|t[e])).toString(16).substr(4)
;return i.substr(0,sjcl.bitArray.bitLength(t)/4)},toBits:function(t){var e,i,r=[];for(i=(t=t.replace(/\s|0x/g,"")).length,t+="00000000",e=0;e<t.length;e+=8)r.push(0^parseInt(t.substr(e,8),16));return sjcl.bitArray.clamp(r,4*i)}},sjcl.codec.base32={
_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",_hexChars:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(t,e,i){sjcl.codec.base32.BITS
;var r,s=sjcl.codec.base32.BASE,n=sjcl.codec.base32.REMAINING,c="",o=0,a=sjcl.codec.base32._chars,l=0,h=sjcl.bitArray.bitLength(t);for(i&&(a=sjcl.codec.base32._hexChars),r=0;c.length*s<h;)c+=a.charAt((l^t[r]>>>o)>>>n),o<s?(l=t[r]<<s-o,o+=n,r++):(l<<=s,o-=s)
;for(;7&c.length&&!e;)c+="=";return c},toBits:function(t,e){t=t.replace(/\s|=/g,"").toUpperCase();var i,r,s=sjcl.codec.base32.BITS,n=sjcl.codec.base32.BASE,c=sjcl.codec.base32.REMAINING,o=[],a=0,l=sjcl.codec.base32._chars,h=0,f="base32"
;for(e&&(l=sjcl.codec.base32._hexChars,f="base32hex"),i=0;i<t.length;i++){if((r=l.indexOf(t.charAt(i)))<0){if(!e)try{return sjcl.codec.base32hex.toBits(t)}catch(t){}throw new sjcl.exception.invalid("this isn't "+f+"!")}a>c?(a-=c,o.push(h^r>>>a),
h=r<<s-a):h^=r<<s-(a+=n)}return 56&a&&o.push(sjcl.bitArray.partial(56&a,h,1)),o}},sjcl.codec.base32hex={fromBits:function(t,e){return sjcl.codec.base32.fromBits(t,e,1)},toBits:function(t){return sjcl.codec.base32.toBits(t,1)}},sjcl.codec.base64={
_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(t,e,i){var r,s="",n=0,c=sjcl.codec.base64._chars,o=0,a=sjcl.bitArray.bitLength(t);for(i&&(c=c.substr(0,62)+"-_"),r=0;6*s.length<a;)s+=c.charAt((o^t[r]>>>n)>>>26),
n<6?(o=t[r]<<6-n,n+=26,r++):(o<<=6,n-=6);for(;3&s.length&&!e;)s+="=";return s},toBits:function(t,e){t=t.replace(/\s|=/g,"");var i,r,s=[],n=0,c=sjcl.codec.base64._chars,o=0;for(e&&(c=c.substr(0,62)+"-_"),i=0;i<t.length;i++){
if((r=c.indexOf(t.charAt(i)))<0)throw new sjcl.exception.invalid("this isn't base64!");n>26?(n-=26,s.push(o^r>>>n),o=r<<32-n):o^=r<<32-(n+=6)}return 56&n&&s.push(sjcl.bitArray.partial(56&n,o,1)),s}},sjcl.codec.base64url={fromBits:function(t){
return sjcl.codec.base64.fromBits(t,1,1)},toBits:function(t){return sjcl.codec.base64.toBits(t,1)}},sjcl.codec.bytes={fromBits:function(t){var e,i,r=[],s=sjcl.bitArray.bitLength(t);for(e=0;e<s/8;e++)0==(3&e)&&(i=t[e/4]),r.push(i>>>24),i<<=8;return r},
toBits:function(t){var e,i=[],r=0;for(e=0;e<t.length;e++)r=r<<8|t[e],3==(3&e)&&(i.push(r),r=0);return 3&e&&i.push(sjcl.bitArray.partial(8*(3&e),r)),i}},sjcl.codec.z85={
_chars:"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ.-:+=^!/*?&<>()[]{}@%$#",
_byteMap:[0,68,0,84,83,82,72,0,75,76,70,65,0,63,62,69,0,1,2,3,4,5,6,7,8,9,64,0,73,66,74,71,81,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,77,0,78,67,0,0,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,79,0,80,0,0],
fromBits:function(t){if(!t)return null;if(0!=sjcl.bitArray.bitLength(t)%32)throw new sjcl.exception.invalid("Invalid bitArray length!");for(var e="",i=sjcl.codec.z85._chars,r=0;r<t.length;++r){for(var s=t[r],n=0,c=0;c<4;++c)n=256*n+(s>>>8*(4-c-1)&255)
;for(var o=52200625;o;)e+=i.charAt(Math.floor(n/o)%85),o=Math.floor(o/85)}var a=5*t.length;if(e.length!==a)throw new sjcl.exception.invalid("Bad Z85 conversion!");return e},toBits:function(t){if(!t)return[]
;if(0!=t.length%5)throw new sjcl.exception.invalid("Invalid Z85 string!");for(var e=[],i=0,r=sjcl.codec.z85._byteMap,s=0,n=0,c=0;c<t.length;)if(i=85*i+r[t[c++].charCodeAt(0)-32],0==c%5){for(var o=16777216;o;)s=s*Math.pow(2,8)+Math.floor(i/o)%256,
4===++n&&(e.push(s),s=0,n=0),o=Math.floor(o/256);i=0}return e}},sjcl.hash.sha256=function(t){this._key[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},sjcl.hash.sha256.hash=function(t){
return(new sjcl.hash.sha256).update(t).finalize()},sjcl.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t))
;var e,i=this._buffer=sjcl.bitArray.concat(this._buffer,t),r=this._length,s=this._length=r+sjcl.bitArray.bitLength(t);if(s>9007199254740991)throw new sjcl.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!=typeof Uint32Array){
var n=new Uint32Array(i),c=0;for(e=512+r-(512+r&511);e<=s;e+=512)this._block(n.subarray(16*c,16*(c+1))),c+=1;i.splice(0,16*c)}else for(e=512+r-(512+r&511);e<=s;e+=512)this._block(i.splice(0,16));return this},finalize:function(){var t,e=this._buffer,i=this._h
;for(t=(e=sjcl.bitArray.concat(e,[sjcl.bitArray.partial(1,1)])).length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,16));return this.reset(),i},_init:[],_key:[],
_precompute:function(){function t(t){return 4294967296*(t-Math.floor(t))|0}for(var e,i,r=0,s=2;r<64;s++){for(i=!0,e=2;e*e<=s;e++)if(s%e==0){i=!1;break}i&&(r<8&&(this._init[r]=t(Math.pow(s,.5))),this._key[r]=t(Math.pow(s,1/3)),r++)}},_block:function(t){
var e,i,r,s,n=this._h,c=this._key,o=n[0],a=n[1],l=n[2],h=n[3],f=n[4],u=n[5],d=n[6],p=n[7];for(e=0;e<64;e++)e<16?i=t[e]:(r=t[e+1&15],s=t[e+14&15],i=t[15&e]=(r>>>7^r>>>18^r>>>3^r<<25^r<<14)+(s>>>17^s>>>19^s>>>10^s<<15^s<<13)+t[15&e]+t[e+9&15]|0),
i=i+p+(f>>>6^f>>>11^f>>>25^f<<26^f<<21^f<<7)+(d^f&(u^d))+c[e],p=d,d=u,u=f,f=h+i|0,h=l,l=a,o=i+((a=o)&l^h&(a^l))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;n[0]=n[0]+o|0,n[1]=n[1]+a|0,n[2]=n[2]+l|0,n[3]=n[3]+h|0,n[4]=n[4]+f|0,n[5]=n[5]+u|0,n[6]=n[6]+d|0,
n[7]=n[7]+p|0}},sjcl.hash.sha512=function(t){this._key[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},sjcl.hash.sha512.hash=function(t){return(new sjcl.hash.sha512).update(t).finalize()},
sjcl.hash.sha512.prototype={blockSize:1024,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t))
;var e,i=this._buffer=sjcl.bitArray.concat(this._buffer,t),r=this._length,s=this._length=r+sjcl.bitArray.bitLength(t);if(s>9007199254740991)throw new sjcl.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!=typeof Uint32Array){
var n=new Uint32Array(i),c=0;for(e=1024+r-(1024+r&1023);e<=s;e+=1024)this._block(n.subarray(32*c,32*(c+1))),c+=1;i.splice(0,32*c)}else for(e=1024+r-(1024+r&1023);e<=s;e+=1024)this._block(i.splice(0,32));return this},finalize:function(){
var t,e=this._buffer,i=this._h;for(t=(e=sjcl.bitArray.concat(e,[sjcl.bitArray.partial(1,1)])).length+4;31&t;t++)e.push(0);for(e.push(0),e.push(0),e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,32))
;return this.reset(),i},_init:[],_initr:[12372232,13281083,9762859,1914609,15106769,4090911,4308331,8266105],_key:[],
_keyr:[2666018,15689165,5061423,9034684,4764984,380953,1658779,7176472,197186,7368638,14987916,16757986,8096111,1480369,13046325,6891156,15813330,5187043,9229749,11312229,2818677,10937475,4324308,1135541,6741931,11809296,16458047,15666916,11046850,698149,229999,945776,13774844,2541862,12856045,9810911,11494366,7844520,15576806,8533307,15795044,4337665,16291729,5553712,15684120,6662416,7413802,12308920,13816008,4303699,9366425,10176680,13195875,4295371,6546291,11712675,15708924,1519456,15772530,6568428,6495784,8568297,13007125,7492395,2515356,12632583,14740254,7262584,1535930,13146278,16321966,1853211,294276,13051027,13221564,1051980,4080310,6651434,14088940,4675607],
_precompute:function(){function t(t){return 4294967296*(t-Math.floor(t))|0}function e(t){return 1099511627776*(t-Math.floor(t))&255}for(var i,r,s=0,n=2;s<80;n++){for(r=!0,i=2;i*i<=n;i++)if(n%i==0){r=!1;break}r&&(s<8&&(this._init[2*s]=t(Math.pow(n,.5)),
this._init[2*s+1]=e(Math.pow(n,.5))<<24|this._initr[s]),this._key[2*s]=t(Math.pow(n,1/3)),this._key[2*s+1]=e(Math.pow(n,1/3))<<24|this._keyr[s],s++)}},_block:function(t){
var e,i,r,s,n=this._h,c=this._key,o=n[0],a=n[1],l=n[2],h=n[3],f=n[4],u=n[5],d=n[6],p=n[7],b=n[8],m=n[9],A=n[10],B=n[11],F=n[12],E=n[13],y=n[14],g=n[15];if("undefined"!=typeof Uint32Array){s=Array(160);for(var j=0;j<32;j++)s[j]=t[j]}else s=t
;var _=o,C=a,v=l,D=h,w=f,x=u,k=d,L=p,M=b,S=m,z=A,R=B,I=F,T=E,q=y,O=g;for(e=0;e<80;e++){if(e<16)i=s[2*e],r=s[2*e+1];else{
var U=s[2*(e-15)],K=s[2*(e-15)+1],P=(K<<31|U>>>1)^(K<<24|U>>>8)^U>>>7,N=(U<<31|K>>>1)^(U<<24|K>>>8)^(U<<25|K>>>7),G=s[2*(e-2)],V=s[2*(e-2)+1],J=(V<<13|G>>>19)^(G<<3|V>>>29)^G>>>6,Y=(G<<13|V>>>19)^(V<<3|G>>>29)^(G<<26|V>>>6),H=s[2*(e-7)],W=s[2*(e-7)+1],X=s[2*(e-16)],Q=s[2*(e-16)+1]
;i=P+H+((r=N+W)>>>0<N>>>0?1:0),i+=J+((r+=Y)>>>0<Y>>>0?1:0),i+=X+((r+=Q)>>>0<Q>>>0?1:0)}s[2*e]=i|=0,s[2*e+1]=r|=0
;var $=M&z^~M&I,Z=S&R^~S&T,tt=_&v^_&w^v&w,et=C&D^C&x^D&x,it=(C<<4|_>>>28)^(_<<30|C>>>2)^(_<<25|C>>>7),rt=(_<<4|C>>>28)^(C<<30|_>>>2)^(C<<25|_>>>7),st=(S<<18|M>>>14)^(S<<14|M>>>18)^(M<<23|S>>>9),nt=(M<<18|S>>>14)^(M<<14|S>>>18)^(S<<23|M>>>9),ct=c[2*e],ot=c[2*e+1],at=O+nt,lt=q+st+(at>>>0<O>>>0?1:0)
;lt+=$+((at+=Z)>>>0<Z>>>0?1:0),lt+=ct+((at+=ot)>>>0<ot>>>0?1:0),lt+=i+((at=at+r|0)>>>0<r>>>0?1:0);var ht=rt+et,ft=it+tt+(ht>>>0<rt>>>0?1:0);q=I,O=T,I=z,T=R,z=M,R=S,M=k+lt+((S=L+at|0)>>>0<L>>>0?1:0)|0,k=w,L=x,w=v,x=D,v=_,D=C,
_=lt+ft+((C=at+ht|0)>>>0<at>>>0?1:0)|0}a=n[1]=a+C|0,n[0]=o+_+(a>>>0<C>>>0?1:0)|0,h=n[3]=h+D|0,n[2]=l+v+(h>>>0<D>>>0?1:0)|0,u=n[5]=u+x|0,n[4]=f+w+(u>>>0<x>>>0?1:0)|0,p=n[7]=p+L|0,n[6]=d+k+(p>>>0<L>>>0?1:0)|0,m=n[9]=m+S|0,n[8]=b+M+(m>>>0<S>>>0?1:0)|0,
B=n[11]=B+R|0,n[10]=A+z+(B>>>0<R>>>0?1:0)|0,E=n[13]=E+T|0,n[12]=F+I+(E>>>0<T>>>0?1:0)|0,g=n[15]=g+O|0,n[14]=y+q+(g>>>0<O>>>0?1:0)|0}},sjcl.hash.sha1=function(t){t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},
sjcl.hash.sha1.hash=function(t){return(new sjcl.hash.sha1).update(t).finalize()},sjcl.hash.sha1.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){
"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t));var e,i=this._buffer=sjcl.bitArray.concat(this._buffer,t),r=this._length,s=this._length=r+sjcl.bitArray.bitLength(t)
;if(s>9007199254740991)throw new sjcl.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!=typeof Uint32Array){var n=new Uint32Array(i),c=0
;for(e=this.blockSize+r-(this.blockSize+r&this.blockSize-1);e<=s;e+=this.blockSize)this._block(n.subarray(16*c,16*(c+1))),c+=1;i.splice(0,16*c)}else for(e=this.blockSize+r-(this.blockSize+r&this.blockSize-1);e<=s;e+=this.blockSize)this._block(i.splice(0,16))
;return this},finalize:function(){var t,e=this._buffer,i=this._h;for(t=(e=sjcl.bitArray.concat(e,[sjcl.bitArray.partial(1,1)])).length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this._length/4294967296)),
e.push(0|this._length);e.length;)this._block(e.splice(0,16));return this.reset(),i},_init:[1732584193,4023233417,2562383102,271733878,3285377520],_key:[1518500249,1859775393,2400959708,3395469782],_f:function(t,e,i,r){
return t<=19?e&i|~e&r:t<=39?e^i^r:t<=59?e&i|e&r|i&r:t<=79?e^i^r:void 0},_S:function(t,e){return e<<t|e>>>32-t},_block:function(t){var e,i,r,s,n,c,o,a,l=this._h;if("undefined"!=typeof Uint32Array){a=Array(80);for(var h=0;h<16;h++)a[h]=t[h]}else a=t;for(r=l[0],
s=l[1],n=l[2],c=l[3],o=l[4],e=0;e<=79;e++)e>=16&&(a[e]=this._S(1,a[e-3]^a[e-8]^a[e-14]^a[e-16])),i=this._S(5,r)+this._f(e,s,n,c)+o+a[e]+this._key[Math.floor(e/20)]|0,o=c,c=n,n=this._S(30,s),s=r,r=i;l[0]=l[0]+r|0,l[1]=l[1]+s|0,l[2]=l[2]+n|0,l[3]=l[3]+c|0,
l[4]=l[4]+o|0}},sjcl.mode.ccm={name:"ccm",_progressListeners:[],listenProgress:function(t){sjcl.mode.ccm._progressListeners.push(t)},unListenProgress:function(t){var e=sjcl.mode.ccm._progressListeners.indexOf(t)
;e>-1&&sjcl.mode.ccm._progressListeners.splice(e,1)},_callProgressListener:function(t){var e,i=sjcl.mode.ccm._progressListeners.slice();for(e=0;e<i.length;e+=1)i[e](t)},encrypt:function(t,e,i,r,s){
var n,c,o=e.slice(0),a=sjcl.bitArray,l=a.bitLength(i)/8,h=a.bitLength(o)/8;if(s=s||64,r=r||[],l<7)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(n=2;n<4&&h>>>8*n;n++);return n<15-l&&(n=15-l),i=a.clamp(i,8*(15-n)),
c=sjcl.mode.ccm._computeTag(t,e,i,r,s,n),o=sjcl.mode.ccm._ctrMode(t,o,i,c,s,n),a.concat(o.data,o.tag)},decrypt:function(t,e,i,r,s){s=s||64,r=r||[];var n,c,o=sjcl.bitArray,a=o.bitLength(i)/8,l=o.bitLength(e),h=o.clamp(e,l-s),f=o.bitSlice(e,l-s);if(l=(l-s)/8,
a<7)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(n=2;n<4&&l>>>8*n;n++);if(n<15-a&&(n=15-a),i=o.clamp(i,8*(15-n)),h=sjcl.mode.ccm._ctrMode(t,h,i,f,s,n),c=sjcl.mode.ccm._computeTag(t,h.data,i,r,s,n),
!o.equal(h.tag,c))throw new sjcl.exception.corrupt("ccm: tag doesn't match");return h.data},_macAdditionalData:function(t,e,i,r,s,n){var c,o,a,l=[],h=sjcl.bitArray,f=h._xor4;if(c=[h.partial(8,(e.length?64:0)|r-2<<2|n-1)],c=h.concat(c,i),c[3]|=s,c=t.encrypt(c),
e.length)for((o=h.bitLength(e)/8)<=65279?l=[h.partial(16,o)]:o<=4294967295&&(l=h.concat([h.partial(16,65534)],[o])),l=h.concat(l,e),a=0;a<l.length;a+=4)c=t.encrypt(f(c,l.slice(a,a+4).concat([0,0,0])));return c},_computeTag:function(t,e,i,r,s,n){
var c,o,a=sjcl.bitArray,l=a._xor4;if((s/=8)%2||s<4||s>16)throw new sjcl.exception.invalid("ccm: invalid tag length");if(r.length>4294967295||e.length>4294967295)throw new sjcl.exception.bug("ccm: can't deal with 4GiB or more data")
;for(c=sjcl.mode.ccm._macAdditionalData(t,r,i,s,a.bitLength(e)/8,n),o=0;o<e.length;o+=4)c=t.encrypt(l(c,e.slice(o,o+4).concat([0,0,0])));return a.clamp(c,8*s)},_ctrMode:function(t,e,i,r,s,n){
var c,o,a,l=sjcl.bitArray,h=l._xor4,f=e.length,u=l.bitLength(e),d=f/50,p=d;if(a=l.concat([l.partial(8,n-1)],i).concat([0,0,0]).slice(0,4),r=l.bitSlice(h(r,t.encrypt(a)),0,s),!f)return{tag:r,data:[]}
;for(o=0;o<f;o+=4)o>d&&(sjcl.mode.ccm._callProgressListener(o/f),d+=p),a[3]++,c=t.encrypt(a),e[o]^=c[0],e[o+1]^=c[1],e[o+2]^=c[2],e[o+3]^=c[3];return{tag:r,data:l.clamp(e,u)}}},void 0===sjcl.beware&&(sjcl.beware={}),
sjcl.beware["CTR mode is dangerous because it doesn't protect message integrity."]=function(){sjcl.mode.ctr={name:"ctr",encrypt:function(t,e,i,r){return sjcl.mode.ctr._calculate(t,e,i,r)},decrypt:function(t,e,i,r){return sjcl.mode.ctr._calculate(t,e,i,r)},
_calculate:function(t,e,i,r){var s,n,c,o,a,l;if(r&&r.length)throw new sjcl.exception.invalid("ctr can't authenticate data");if(128!==sjcl.bitArray.bitLength(i))throw new sjcl.exception.invalid("ctr iv must be 128 bits");if(!(s=e.length))return[]
;for(c=i.slice(0),o=e.slice(0),n=sjcl.bitArray.bitLength(o),l=0;l<s;l+=4)a=t.encrypt(c),o[l]^=a[0],o[l+1]^=a[1],o[l+2]^=a[2],o[l+3]^=a[3],c[3]++;return sjcl.bitArray.clamp(o,n)}}},void 0===sjcl.beware&&(sjcl.beware={}),
sjcl.beware["CBC mode is dangerous because it doesn't protect message integrity."]=function(){sjcl.mode.cbc={name:"cbc",encrypt:function(t,e,i,r){if(r&&r.length)throw new sjcl.exception.invalid("cbc can't authenticate data")
;if(128!==sjcl.bitArray.bitLength(i))throw new sjcl.exception.invalid("cbc iv must be 128 bits");var s,n=sjcl.bitArray,c=n._xor4,o=n.bitLength(e),a=0,l=[];if(7&o)throw new sjcl.exception.invalid("pkcs#5 padding only works for multiples of a byte")
;for(s=0;a+128<=o;s+=4,a+=128)i=t.encrypt(c(i,e.slice(s,s+4))),l.splice(s,0,i[0],i[1],i[2],i[3]);return o=16843009*(16-(o>>3&15)),i=t.encrypt(c(i,n.concat(e,[o,o,o,o]).slice(s,s+4))),l.splice(s,0,i[0],i[1],i[2],i[3]),l},decrypt:function(t,e,i,r){
if(r&&r.length)throw new sjcl.exception.invalid("cbc can't authenticate data");if(128!==sjcl.bitArray.bitLength(i))throw new sjcl.exception.invalid("cbc iv must be 128 bits")
;if(127&sjcl.bitArray.bitLength(e)||!e.length)throw new sjcl.exception.corrupt("cbc ciphertext must be a positive multiple of the block size");var s,n,c,o=sjcl.bitArray,a=o._xor4,l=[];for(r=r||[],s=0;s<e.length;s+=4)n=e.slice(s,s+4),c=a(i,t.decrypt(n)),
l.splice(s,0,c[0],c[1],c[2],c[3]),i=n;if(0===(n=255&l[s-1])||n>16)throw new sjcl.exception.corrupt("pkcs#5 padding corrupt");if(c=16843009*n,
!o.equal(o.bitSlice([c,c,c,c],0,8*n),o.bitSlice(l,32*l.length-8*n,32*l.length)))throw new sjcl.exception.corrupt("pkcs#5 padding corrupt");return o.bitSlice(l,0,32*l.length-8*n)}}},sjcl.mode.ocb2={name:"ocb2",encrypt:function(t,e,i,r,s,n){
if(128!==sjcl.bitArray.bitLength(i))throw new sjcl.exception.invalid("ocb iv must be 128 bits");var c,o,a,l,h=sjcl.mode.ocb2._times2,f=sjcl.bitArray,u=f._xor4,d=[0,0,0,0],p=h(t.encrypt(i)),b=[];for(r=r||[],s=s||64,c=0;c+4<e.length;c+=4)d=u(d,o=e.slice(c,c+4)),
b=b.concat(u(p,t.encrypt(u(p,o)))),p=h(p);return o=e.slice(c),a=f.bitLength(o),l=t.encrypt(u(p,[0,0,0,a])),o=f.clamp(u(o.concat([0,0,0]),l),a),d=u(d,u(o.concat([0,0,0]),l)),d=t.encrypt(u(d,u(p,h(p)))),r.length&&(d=u(d,n?r:sjcl.mode.ocb2.pmac(t,r))),
b.concat(f.concat(o,f.clamp(d,s)))},decrypt:function(t,e,i,r,s,n){if(128!==sjcl.bitArray.bitLength(i))throw new sjcl.exception.invalid("ocb iv must be 128 bits");s=s||64
;var c,o,a,l,h=sjcl.mode.ocb2._times2,f=sjcl.bitArray,u=f._xor4,d=[0,0,0,0],p=h(t.encrypt(i)),b=sjcl.bitArray.bitLength(e)-s,m=[];for(r=r||[],c=0;c+4<b/32;c+=4)d=u(d,o=u(p,t.decrypt(u(p,e.slice(c,c+4))))),m=m.concat(o),p=h(p);if(a=b-32*c,
l=t.encrypt(u(p,[0,0,0,a])),o=u(l,f.clamp(e.slice(c),a).concat([0,0,0])),d=u(d,o),d=t.encrypt(u(d,u(p,h(p)))),r.length&&(d=u(d,n?r:sjcl.mode.ocb2.pmac(t,r))),!f.equal(f.clamp(d,s),f.bitSlice(e,b)))throw new sjcl.exception.corrupt("ocb: tag doesn't match")
;return m.concat(f.clamp(o,a))},pmac:function(t,e){var i,r,s=sjcl.mode.ocb2._times2,n=sjcl.bitArray,c=n._xor4,o=[0,0,0,0],a=t.encrypt([0,0,0,0]);for(a=c(a,s(s(a))),i=0;i+4<e.length;i+=4)a=s(a),o=c(o,t.encrypt(c(a,e.slice(i,i+4))));return r=e.slice(i),
n.bitLength(r)<128&&(a=c(a,s(a)),r=n.concat(r,[-2147483648,0,0,0])),o=c(o,r),t.encrypt(c(s(c(a,s(a))),o))},_times2:function(t){return[t[0]<<1^t[1]>>>31,t[1]<<1^t[2]>>>31,t[2]<<1^t[3]>>>31,t[3]<<1^135*(t[0]>>>31)]}},sjcl.mode.ocb2progressive={
createEncryptor:function(t,e,i,r,s){if(128!==sjcl.bitArray.bitLength(e))throw new sjcl.exception.invalid("ocb iv must be 128 bits");var n,c,o,a,l=sjcl.mode.ocb2._times2,h=sjcl.bitArray,f=h._xor4,u=[0,0,0,0],d=l(t.encrypt(e)),p=[];return i=i||[],r=r||64,{
process:function(e){if(0==sjcl.bitArray.bitLength(e))return[];var i=[];for(p=p.concat(e),n=0;n+4<p.length;n+=4)c=p.slice(n,n+4),u=f(u,c),i=i.concat(f(d,t.encrypt(f(d,c)))),d=l(d);return p=p.slice(n),i},finalize:function(){return c=p,o=h.bitLength(c),
a=t.encrypt(f(d,[0,0,0,o])),c=h.clamp(f(c.concat([0,0,0]),a),o),u=f(u,f(c.concat([0,0,0]),a)),u=t.encrypt(f(u,f(d,l(d)))),i.length&&(u=f(u,s?i:sjcl.mode.ocb2.pmac(t,i))),h.concat(c,h.clamp(u,r))}}},createDecryptor:function(t,e,i,r,s){
if(128!==sjcl.bitArray.bitLength(e))throw new sjcl.exception.invalid("ocb iv must be 128 bits");r=r||64;var n,c,o,a,l=sjcl.mode.ocb2._times2,h=sjcl.bitArray,f=h._xor4,u=[0,0,0,0],d=l(t.encrypt(e)),p=[];return i=i||[],{process:function(e){
if(0==e.length)return[];var i=[];p=p.concat(e);var s=sjcl.bitArray.bitLength(p);for(n=0;n+4<(s-r)/32;n+=4)c=f(d,t.decrypt(f(d,p.slice(n,n+4)))),u=f(u,c),i=i.concat(c),d=l(d);return p=p.slice(n),i},finalize:function(){if(o=sjcl.bitArray.bitLength(p)-r,
a=t.encrypt(f(d,[0,0,0,o])),c=f(a,h.clamp(p,o).concat([0,0,0])),u=f(u,c),u=t.encrypt(f(u,f(d,l(d)))),i.length&&(u=f(u,s?i:sjcl.mode.ocb2.pmac(t,i))),!h.equal(h.clamp(u,r),h.bitSlice(p,o)))throw new sjcl.exception.corrupt("ocb: tag doesn't match")
;return h.clamp(c,o)}}}},sjcl.mode.gcm={name:"gcm",encrypt:function(t,e,i,r,s){var n,c=e.slice(0),o=sjcl.bitArray;return s=s||128,r=r||[],n=sjcl.mode.gcm._ctrMode(!0,t,c,r,i,s),o.concat(n.data,n.tag)},decrypt:function(t,e,i,r,s){
var n,c,o=e.slice(0),a=sjcl.bitArray,l=a.bitLength(o);if(s=s||128,r=r||[],s<=l?(c=a.bitSlice(o,l-s),o=a.bitSlice(o,0,l-s)):(c=o,o=[]),n=sjcl.mode.gcm._ctrMode(!1,t,o,r,i,s),!a.equal(n.tag,c))throw new sjcl.exception.corrupt("gcm: tag doesn't match")
;return n.data},_galoisMultiply:function(t,e){var i,r,s,n,c,o=sjcl.bitArray._xor4;for(s=[0,0,0,0],n=e.slice(0),i=0;i<128;i++){for(0!=(t[Math.floor(i/32)]&1<<31-i%32)&&(s=o(s,n)),c=0!=(1&n[3]),r=3;r>0;r--)n[r]=n[r]>>>1|(1&n[r-1])<<31;n[0]=n[0]>>>1,
c&&(n[0]=n[0]^225<<24)}return s},_ghash:function(t,e,i){var r,s,n=i.length;for(r=e.slice(0),s=0;s<n;s+=4)r[0]^=4294967295&i[s],r[1]^=4294967295&i[s+1],r[2]^=4294967295&i[s+2],r[3]^=4294967295&i[s+3],r=sjcl.mode.gcm._galoisMultiply(r,t);return r},
_ctrMode:function(t,e,i,r,s,n){var c,o,a,l,h,f,u,d,p,b,m,A,B=sjcl.bitArray;for(p=i.length,b=B.bitLength(i),m=B.bitLength(r),A=B.bitLength(s),c=e.encrypt([0,0,0,0]),96===A?(o=s.slice(0),o=B.concat(o,[1])):(o=sjcl.mode.gcm._ghash(c,[0,0,0,0],s),
o=sjcl.mode.gcm._ghash(c,o,[0,0,Math.floor(A/4294967296),4294967295&A])),a=sjcl.mode.gcm._ghash(c,[0,0,0,0],r),f=o.slice(0),u=a.slice(0),t||(u=sjcl.mode.gcm._ghash(c,a,i)),h=0;h<p;h+=4)f[3]++,l=e.encrypt(f),i[h]^=l[0],i[h+1]^=l[1],i[h+2]^=l[2],i[h+3]^=l[3]
;return i=B.clamp(i,b),t&&(u=sjcl.mode.gcm._ghash(c,a,i)),d=[Math.floor(m/4294967296),4294967295&m,Math.floor(b/4294967296),4294967295&b],u=sjcl.mode.gcm._ghash(c,u,d),l=e.encrypt(o),u[0]^=l[0],u[1]^=l[1],u[2]^=l[2],u[3]^=l[3],{tag:B.bitSlice(u,0,n),data:i}}},
sjcl.misc.hmac=function(t,e){this._hash=e=e||sjcl.hash.sha256;var i,r=[[],[]],s=e.prototype.blockSize/32;for(this._baseHash=[new e,new e],t.length>s&&(t=e.hash(t)),i=0;i<s;i++)r[0][i]=909522486^t[i],r[1][i]=1549556828^t[i];this._baseHash[0].update(r[0]),
this._baseHash[1].update(r[1]),this._resultHash=new e(this._baseHash[0])},sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(t){if(this._updated)throw new sjcl.exception.invalid("encrypt on already updated hmac called!")
;return this.update(t),this.digest(t)},sjcl.misc.hmac.prototype.reset=function(){this._resultHash=new this._hash(this._baseHash[0]),this._updated=!1},sjcl.misc.hmac.prototype.update=function(t){this._updated=!0,this._resultHash.update(t)},
sjcl.misc.hmac.prototype.digest=function(){var t=this._resultHash.finalize(),e=new this._hash(this._baseHash[1]).update(t).finalize();return this.reset(),e},sjcl.misc.pbkdf2=function(t,e,i,r,s){if(i=i||1e4,
r<0||i<0)throw new sjcl.exception.invalid("invalid params to pbkdf2");"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t)),"string"==typeof e&&(e=sjcl.codec.utf8String.toBits(e));var n,c,o,a,l,h=new(s=s||sjcl.misc.hmac)(t),f=[],u=sjcl.bitArray
;for(l=1;32*f.length<(r||1);l++){for(n=c=h.encrypt(u.concat(e,[l])),o=1;o<i;o++)for(c=h.encrypt(c),a=0;a<c.length;a++)n[a]^=c[a];f=f.concat(n)}return r&&(f=u.clamp(f,r)),f},sjcl.misc.scrypt=function(t,e,i,r,s,n,c){var o=Math.pow(2,32)-1,a=sjcl.misc.scrypt
;if(i=i||16384,r=r||8,s=s||1,r*s>=Math.pow(2,30))throw sjcl.exception.invalid("The parameters r, p must satisfy r * p < 2^30");if(i<2||i&i-1!=0)throw sjcl.exception.invalid("The parameter N must be a power of 2.")
;if(i>o/128/r)throw sjcl.exception.invalid("N too big.");if(r>o/128/s)throw sjcl.exception.invalid("r too big.");var l=sjcl.misc.pbkdf2(t,e,1,128*s*r*8,c),h=l.length/s;a.reverse(l);for(var f=0;f<s;f++){var u=l.slice(f*h,(f+1)*h)
;a.blockcopy(a.ROMix(u,i),0,l,f*h)}return a.reverse(l),sjcl.misc.pbkdf2(t,l,1,n,c)},sjcl.misc.scrypt.salsa20Core=function(t,e){for(var i=function(t,e){return t<<e|t>>>32-e},r=t.slice(0),s=e;s>0;s-=2)r[4]^=i(r[0]+r[12],7),r[8]^=i(r[4]+r[0],9),
r[12]^=i(r[8]+r[4],13),r[0]^=i(r[12]+r[8],18),r[9]^=i(r[5]+r[1],7),r[13]^=i(r[9]+r[5],9),r[1]^=i(r[13]+r[9],13),r[5]^=i(r[1]+r[13],18),r[14]^=i(r[10]+r[6],7),r[2]^=i(r[14]+r[10],9),r[6]^=i(r[2]+r[14],13),r[10]^=i(r[6]+r[2],18),r[3]^=i(r[15]+r[11],7),
r[7]^=i(r[3]+r[15],9),r[11]^=i(r[7]+r[3],13),r[15]^=i(r[11]+r[7],18),r[1]^=i(r[0]+r[3],7),r[2]^=i(r[1]+r[0],9),r[3]^=i(r[2]+r[1],13),r[0]^=i(r[3]+r[2],18),r[6]^=i(r[5]+r[4],7),r[7]^=i(r[6]+r[5],9),r[4]^=i(r[7]+r[6],13),r[5]^=i(r[4]+r[7],18),
r[11]^=i(r[10]+r[9],7),r[8]^=i(r[11]+r[10],9),r[9]^=i(r[8]+r[11],13),r[10]^=i(r[9]+r[8],18),r[12]^=i(r[15]+r[14],7),r[13]^=i(r[12]+r[15],9),r[14]^=i(r[13]+r[12],13),r[15]^=i(r[14]+r[13],18);for(s=0;s<16;s++)t[s]=r[s]+t[s]},
sjcl.misc.scrypt.blockMix=function(t){for(var e=t.slice(-16),i=[],r=t.length/16,s=sjcl.misc.scrypt,n=0;n<r;n++)s.blockxor(t,16*n,e,0,16),s.salsa20Core(e,8),0==(1&n)?s.blockcopy(e,0,i,8*n):s.blockcopy(e,0,i,8*(n^1+r));return i},
sjcl.misc.scrypt.ROMix=function(t,e){for(var i=t.slice(0),r=[],s=sjcl.misc.scrypt,n=0;n<e;n++)r.push(i.slice(0)),i=s.blockMix(i);for(n=0;n<e;n++){var c=i[i.length-16]&e-1;s.blockxor(r[c],0,i,0),i=s.blockMix(i)}return i},sjcl.misc.scrypt.reverse=function(t){
for(var e in t){var i=255&t[e];i=(i=(i=i<<8|t[e]>>>8&255)<<8|t[e]>>>16&255)<<8|t[e]>>>24&255,t[e]=i}},sjcl.misc.scrypt.blockcopy=function(t,e,i,r,s){var n;for(s=s||t.length-e,n=0;n<s;n++)i[r+n]=0|t[e+n]},sjcl.misc.scrypt.blockxor=function(t,e,i,r,s){var n
;for(s=s||t.length-e,n=0;n<s;n++)i[r+n]=i[r+n]^t[e+n]|0},sjcl.prng=function(t){this._pools=[new sjcl.hash.sha256],this._poolEntropy=[0],this._reseedCount=0,this._robins={},this._eventId=0,this._collectorIds={},this._collectorIdNext=0,this._strength=0,
this._poolStrength=0,this._nextReseed=0,this._key=[0,0,0,0,0,0,0,0],this._counter=[0,0,0,0],this._cipher=void 0,this._defaultParanoia=t,this._collectorsStarted=!1,this._callbacks={progress:{},seeded:{}},this._callbackI=0,this._NOT_READY=0,this._READY=1,
this._REQUIRES_RESEED=2,this._MAX_WORDS_PER_BURST=65536,this._PARANOIA_LEVELS=[0,48,64,96,128,192,256,384,512,768,1024],this._MILLISECONDS_PER_RESEED=3e4,this._BITS_PER_RESEED=80},sjcl.prng.prototype={randomWords:function(t,e){var i,r,s=[],n=this.isReady(e)
;if(n===this._NOT_READY)throw new sjcl.exception.notReady("generator isn't seeded");for(n&this._REQUIRES_RESEED&&this._reseedFromPools(!(n&this._READY)),i=0;i<t;i+=4)(i+1)%this._MAX_WORDS_PER_BURST==0&&this._gate(),r=this._gen4words(),
s.push(r[0],r[1],r[2],r[3]);return this._gate(),s.slice(0,t)},setDefaultParanoia:function(t,e){
if(0===t&&"Setting paranoia=0 will ruin your security; use it only for testing"!==e)throw new sjcl.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this._defaultParanoia=t},addEntropy:function(t,e,i){i=i||"user"
;var r,s,n,c,o=(new Date).valueOf(),a=this._robins[i],l=this.isReady(),h=0;switch(void 0===(r=this._collectorIds[i])&&(r=this._collectorIds[i]=this._collectorIdNext++),void 0===a&&(a=this._robins[i]=0),this._robins[i]=(this._robins[i]+1)%this._pools.length,
typeof t){case"number":void 0===e&&(e=1),this._pools[a].update([r,this._eventId++,1,e,o,1,0|t]);break;case"object":if("[object Uint32Array]"===(c=Object.prototype.toString.call(t))){for(n=[],s=0;s<t.length;s++)n.push(t[s]);t=n
}else for("[object Array]"!==c&&(h=1),s=0;s<t.length&&!h;s++)"number"!=typeof t[s]&&(h=1);if(!h){if(void 0===e)for(e=0,s=0;s<t.length;s++)for(n=t[s];n>0;)e++,n>>>=1;this._pools[a].update([r,this._eventId++,2,e,o,t.length].concat(t))}break;case"string":
void 0===e&&(e=t.length),this._pools[a].update([r,this._eventId++,3,e,o,t.length]),this._pools[a].update(t);break;default:h=1}if(h)throw new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string");this._poolEntropy[a]+=e,
this._poolStrength+=e,l===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(t){
var e=this._PARANOIA_LEVELS[void 0!==t?t:this._defaultParanoia]
;return this._strength&&this._strength>=e?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=e?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},
getProgress:function(t){var e=this._PARANOIA_LEVELS[t||this._defaultParanoia];return this._strength>=e?1:this._poolStrength>e?1:this._poolStrength/e},startCollectors:function(){if(!this._collectorsStarted){if(this._eventListener={
loadTimeCollector:this._bind(this._loadTimeCollector),mouseCollector:this._bind(this._mouseCollector),keyboardCollector:this._bind(this._keyboardCollector),accelerometerCollector:this._bind(this._accelerometerCollector),
touchCollector:this._bind(this._touchCollector)},window.addEventListener)window.addEventListener("load",this._eventListener.loadTimeCollector,!1),window.addEventListener("mousemove",this._eventListener.mouseCollector,!1),
window.addEventListener("keypress",this._eventListener.keyboardCollector,!1),window.addEventListener("devicemotion",this._eventListener.accelerometerCollector,!1),window.addEventListener("touchmove",this._eventListener.touchCollector,!1);else{
if(!document.attachEvent)throw new sjcl.exception.bug("can't attach event");document.attachEvent("onload",this._eventListener.loadTimeCollector),document.attachEvent("onmousemove",this._eventListener.mouseCollector),
document.attachEvent("keypress",this._eventListener.keyboardCollector)}this._collectorsStarted=!0}},stopCollectors:function(){this._collectorsStarted&&(window.removeEventListener?(window.removeEventListener("load",this._eventListener.loadTimeCollector,!1),
window.removeEventListener("mousemove",this._eventListener.mouseCollector,!1),window.removeEventListener("keypress",this._eventListener.keyboardCollector,!1),window.removeEventListener("devicemotion",this._eventListener.accelerometerCollector,!1),
window.removeEventListener("touchmove",this._eventListener.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this._eventListener.loadTimeCollector),document.detachEvent("onmousemove",this._eventListener.mouseCollector),
document.detachEvent("keypress",this._eventListener.keyboardCollector)),this._collectorsStarted=!1)},addEventListener:function(t,e){this._callbacks[t][this._callbackI++]=e},removeEventListener:function(t,e){var i,r,s=this._callbacks[t],n=[]
;for(r in s)s.hasOwnProperty(r)&&s[r]===e&&n.push(r);for(i=0;i<n.length;i++)delete s[r=n[i]]},_bind:function(t){var e=this;return function(){t.apply(e,arguments)}},_gen4words:function(){for(var t=0;t<4&&(this._counter[t]=this._counter[t]+1|0,
!this._counter[t]);t++);return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new sjcl.cipher.aes(this._key)},_reseed:function(t){this._key=sjcl.hash.sha256.hash(this._key.concat(t)),
this._cipher=new sjcl.cipher.aes(this._key);for(var e=0;e<4&&(this._counter[e]=this._counter[e]+1|0,!this._counter[e]);e++);},_reseedFromPools:function(t){var e,i=[],r=0;for(this._nextReseed=i[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED,
e=0;e<16;e++)i.push(4294967296*Math.random()|0);for(e=0;e<this._pools.length&&(i=i.concat(this._pools[e].finalize()),r+=this._poolEntropy[e],this._poolEntropy[e]=0,t||!(this._reseedCount&1<<e));e++);
this._reseedCount>=1<<this._pools.length&&(this._pools.push(new sjcl.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=r,r>this._strength&&(this._strength=r),this._reseedCount++,this._reseed(i)},_keyboardCollector:function(){
this._addCurrentTimeToEntropy(1)},_mouseCollector:function(t){var e,i;try{e=t.x||t.clientX||t.offsetX||0,i=t.y||t.clientY||t.offsetY||0}catch(t){e=0,i=0}0!=e&&0!=i&&this.addEntropy([e,i],2,"mouse"),this._addCurrentTimeToEntropy(0)},_touchCollector:function(t){
var e=t.touches[0]||t.changedTouches[0],i=e.pageX||e.clientX,r=e.pageY||e.clientY;this.addEntropy([i,r],1,"touch"),this._addCurrentTimeToEntropy(0)},_loadTimeCollector:function(){this._addCurrentTimeToEntropy(2)},_addCurrentTimeToEntropy:function(t){
"undefined"!=typeof window&&window.performance&&"function"==typeof window.performance.now?this.addEntropy(window.performance.now(),t,"loadtime"):this.addEntropy((new Date).valueOf(),t,"loadtime")},_accelerometerCollector:function(t){
var e=t.accelerationIncludingGravity.x||t.accelerationIncludingGravity.y||t.accelerationIncludingGravity.z;if(window.orientation){var i=window.orientation;"number"==typeof i&&this.addEntropy(i,1,"accelerometer")}e&&this.addEntropy(e,2,"accelerometer"),
this._addCurrentTimeToEntropy(0)},_fireEvent:function(t,e){var i,r=sjcl.random._callbacks[t],s=[];for(i in r)r.hasOwnProperty(i)&&s.push(r[i]);for(i=0;i<s.length;i++)s[i](e)}},sjcl.random=new sjcl.prng(6),function(){try{var t,e,i
;if("undefined"!=typeof module&&module.exports&&(e=function(){try{return require("crypto")}catch(t){return null}}())&&e.randomBytes)t=e.randomBytes(128),t=new Uint32Array(new Uint8Array(t).buffer),
sjcl.random.addEntropy(t,1024,"crypto.randomBytes");else if("undefined"!=typeof window&&"undefined"!=typeof Uint32Array){if(i=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(i);else{
if(!window.msCrypto||!window.msCrypto.getRandomValues)return;window.msCrypto.getRandomValues(i)}sjcl.random.addEntropy(i,1024,"crypto.getRandomValues")}}catch(t){
"undefined"!=typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(t))}}(),sjcl.json={defaults:{v:1,iter:1e4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},_encrypt:function(t,e,i,r){i=i||{},r=r||{}
;var s,n,c,o=sjcl.json,a=o._add({iv:sjcl.random.randomWords(4,0)},o.defaults);if(o._add(a,i),c=a.adata,"string"==typeof a.salt&&(a.salt=sjcl.codec.base64.toBits(a.salt)),"string"==typeof a.iv&&(a.iv=sjcl.codec.base64.toBits(a.iv)),
!sjcl.mode[a.mode]||!sjcl.cipher[a.cipher]||"string"==typeof t&&a.iter<=100||64!==a.ts&&96!==a.ts&&128!==a.ts||128!==a.ks&&192!==a.ks&&256!==a.ks||a.iv.length<2||a.iv.length>4)throw new sjcl.exception.invalid("json encrypt: invalid parameters")
;return"string"==typeof t?(t=(s=sjcl.misc.cachedPbkdf2(t,a)).key.slice(0,a.ks/32),a.salt=s.salt):sjcl.ecc&&t instanceof sjcl.ecc.elGamal.publicKey&&(s=t.kem(),a.kemtag=s.tag,t=s.key.slice(0,a.ks/32)),"string"==typeof e&&(e=sjcl.codec.utf8String.toBits(e)),
"string"==typeof c&&(a.adata=c=sjcl.codec.utf8String.toBits(c)),n=new sjcl.cipher[a.cipher](t),o._add(r,a),r.key=t,
"ccm"===a.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&e instanceof ArrayBuffer?a.ct=sjcl.arrayBuffer.ccm.encrypt(n,e,a.iv,c,a.ts):a.ct=sjcl.mode[a.mode].encrypt(n,e,a.iv,c,a.ts),a},encrypt:function(t,e,i,r){var s=sjcl.json,n=s._encrypt.apply(s,arguments)
;return s.encode(n)},_decrypt:function(t,e,i,r){i=i||{},r=r||{};var s,n,c,o=sjcl.json,a=o._add(o._add(o._add({},o.defaults),e),i,!0),l=a.adata;if("string"==typeof a.salt&&(a.salt=sjcl.codec.base64.toBits(a.salt)),
"string"==typeof a.iv&&(a.iv=sjcl.codec.base64.toBits(a.iv)),
!sjcl.mode[a.mode]||!sjcl.cipher[a.cipher]||"string"==typeof t&&a.iter<=100||64!==a.ts&&96!==a.ts&&128!==a.ts||128!==a.ks&&192!==a.ks&&256!==a.ks||!a.iv||a.iv.length<2||a.iv.length>4)throw new sjcl.exception.invalid("json decrypt: invalid parameters")
;return"string"==typeof t?(t=(n=sjcl.misc.cachedPbkdf2(t,a)).key.slice(0,a.ks/32),a.salt=n.salt):sjcl.ecc&&t instanceof sjcl.ecc.elGamal.secretKey&&(t=t.unkem(sjcl.codec.base64.toBits(a.kemtag)).slice(0,a.ks/32)),
"string"==typeof l&&(l=sjcl.codec.utf8String.toBits(l)),c=new sjcl.cipher[a.cipher](t),
s="ccm"===a.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&a.ct instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.decrypt(c,a.ct,a.iv,a.tag,l,a.ts):sjcl.mode[a.mode].decrypt(c,a.ct,a.iv,l,a.ts),o._add(r,a),r.key=t,1===i.raw?s:sjcl.codec.utf8String.fromBits(s)},
decrypt:function(t,e,i,r){var s=sjcl.json;return s._decrypt(t,s.decode(e),i,r)},encode:function(t){var e,i="{",r="";for(e in t)if(t.hasOwnProperty(e)){if(!e.match(/^[a-z0-9]+$/i))throw new sjcl.exception.invalid("json encode: invalid property name")
;switch(i+=r+'"'+e+'":',r=",",typeof t[e]){case"number":case"boolean":i+=t[e];break;case"string":i+='"'+escape(t[e])+'"';break;case"object":i+='"'+sjcl.codec.base64.fromBits(t[e],0)+'"';break;default:
throw new sjcl.exception.bug("json encode: unsupported type")}}return i+"}"},decode:function(t){if(!(t=t.replace(/\s/g,"")).match(/^\{.*\}$/))throw new sjcl.exception.invalid("json decode: this isn't json!");var e,i,r=t.replace(/^\{|\}$/g,"").split(/,/),s={}
;for(e=0;e<r.length;e++){if(!(i=r[e].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i)))throw new sjcl.exception.invalid("json decode: this isn't json!")
;null!=i[3]?s[i[2]]=parseInt(i[3],10):null!=i[4]?s[i[2]]=i[2].match(/^(ct|adata|salt|iv)$/)?sjcl.codec.base64.toBits(i[4]):unescape(i[4]):null!=i[5]&&(s[i[2]]="true"===i[5])}return s},_add:function(t,e,i){if(void 0===t&&(t={}),void 0===e)return t;var r
;for(r in e)if(e.hasOwnProperty(r)){if(i&&void 0!==t[r]&&t[r]!==e[r])throw new sjcl.exception.invalid("required parameter overridden");t[r]=e[r]}return t},_subtract:function(t,e){var i,r={};for(i in t)t.hasOwnProperty(i)&&t[i]!==e[i]&&(r[i]=t[i]);return r},
_filter:function(t,e){var i,r={};for(i=0;i<e.length;i++)void 0!==t[e[i]]&&(r[e[i]]=t[e[i]]);return r}},sjcl.encrypt=sjcl.json.encrypt,sjcl.decrypt=sjcl.json.decrypt,sjcl.misc._pbkdf2Cache={},sjcl.misc.cachedPbkdf2=function(t,e){
var i,r,s,n,c=sjcl.misc._pbkdf2Cache;return e=e||{},n=e.iter||1e3,r=c[t]=c[t]||{},i=r[n]=r[n]||{firstSalt:e.salt&&e.salt.length?e.salt.slice(0):sjcl.random.randomWords(2,0)},s=void 0===e.salt?i.firstSalt:e.salt,i[s]=i[s]||sjcl.misc.pbkdf2(t,s,e.iter),{
key:i[s].slice(0),salt:s.slice(0)}},sjcl.bn=function(t){this.initWith(t)},sjcl.bn.prototype={radix:24,maxMul:8,_class:sjcl.bn,copy:function(){return new this._class(this)},initWith:function(t){var e,i=0;switch(typeof t){case"object":this.limbs=t.limbs.slice(0)
;break;case"number":this.limbs=[t],this.normalize();break;case"string":for(t=t.replace(/^0x/,""),this.limbs=[],e=this.radix/4,i=0;i<t.length;i+=e)this.limbs.push(parseInt(t.substring(Math.max(t.length-i-e,0),t.length-i),16));break;default:this.limbs=[0]}
return this},equals:function(t){"number"==typeof t&&(t=new this._class(t));var e,i=0;for(this.fullReduce(),t.fullReduce(),e=0;e<this.limbs.length||e<t.limbs.length;e++)i|=this.getLimb(e)^t.getLimb(e);return 0===i},getLimb:function(t){
return t>=this.limbs.length?0:this.limbs[t]},greaterEquals:function(t){"number"==typeof t&&(t=new this._class(t));var e,i,r,s=0,n=0;for(e=Math.max(this.limbs.length,t.limbs.length)-1;e>=0;e--)s|=(i=this.getLimb(e))-(r=t.getLimb(e))&~(n|=r-i&~s)
;return(n|~s)>>>31},toString:function(){this.fullReduce();var t,e,i="",r=this.limbs;for(t=0;t<this.limbs.length;t++){for(e=r[t].toString(16);t<this.limbs.length-1&&e.length<6;)e="0"+e;i=e+i}return"0x"+i},addM:function(t){
"object"!=typeof t&&(t=new this._class(t));var e,i=this.limbs,r=t.limbs;for(e=i.length;e<r.length;e++)i[e]=0;for(e=0;e<r.length;e++)i[e]+=r[e];return this},doubleM:function(){var t,e,i=0,r=this.radix,s=this.radixMask,n=this.limbs
;for(t=0;t<n.length;t++)e=(e=n[t])+e+i,n[t]=e&s,i=e>>r;return i&&n.push(i),this},halveM:function(){var t,e,i=0,r=this.radix,s=this.limbs;for(t=s.length-1;t>=0;t--)e=s[t],s[t]=e+i>>1,i=(1&e)<<r;return s[s.length-1]||s.pop(),this},subM:function(t){
"object"!=typeof t&&(t=new this._class(t));var e,i=this.limbs,r=t.limbs;for(e=i.length;e<r.length;e++)i[e]=0;for(e=0;e<r.length;e++)i[e]-=r[e];return this},mod:function(t){var e=!this.greaterEquals(new sjcl.bn(0));t=new sjcl.bn(t).normalize()
;var i=new sjcl.bn(this).normalize(),r=0;for(e&&(i=new sjcl.bn(0).subM(i).normalize());i.greaterEquals(t);r++)t.doubleM();for(e&&(i=t.sub(i).normalize());r>0;r--)t.halveM(),i.greaterEquals(t)&&i.subM(t).normalize();return i.trim()},inverseMod:function(t){
var e,i,r=new sjcl.bn(1),s=new sjcl.bn(0),n=new sjcl.bn(this),c=new sjcl.bn(t),o=1;if(!(1&t.limbs[0]))throw new sjcl.exception.invalid("inverseMod: p must be odd");do{for(1&n.limbs[0]&&(n.greaterEquals(c)||(e=n,n=c,c=e,e=r,r=s,s=e),n.subM(c),n.normalize(),
r.greaterEquals(s)||r.addM(t),r.subM(s)),n.halveM(),1&r.limbs[0]&&r.addM(t),r.normalize(),r.halveM(),i=o=0;i<n.limbs.length;i++)o|=n.limbs[i]}while(o);if(!c.equals(1))throw new sjcl.exception.invalid("inverseMod: p and x must be relatively prime");return s},
add:function(t){return this.copy().addM(t)},sub:function(t){return this.copy().subM(t)},mul:function(t){"number"==typeof t&&(t=new this._class(t));var e,i,r,s=this.limbs,n=t.limbs,c=s.length,o=n.length,a=new this._class,l=a.limbs,h=this.maxMul
;for(e=0;e<this.limbs.length+t.limbs.length+1;e++)l[e]=0;for(e=0;e<c;e++){for(r=s[e],i=0;i<o;i++)l[e+i]+=r*n[i];--h||(h=this.maxMul,a.cnormalize())}return a.cnormalize().reduce()},square:function(){return this.mul(this)},power:function(t){
t=new sjcl.bn(t).normalize().trim().limbs;var e,i,r=new this._class(1),s=this;for(e=0;e<t.length;e++)for(i=0;i<this.radix&&(t[e]&1<<i&&(r=r.mul(s)),e!=t.length-1||t[e]>>i+1!=0);i++)s=s.square();return r},mulmod:function(t,e){
return this.mod(e).mul(t.mod(e)).mod(e)},powermod:function(t,e){if(t=new sjcl.bn(t),1==(1&(e=new sjcl.bn(e)).limbs[0])){var i=this.montpowermod(t,e);if(0!=i)return i}var r,s,n=t.normalize().trim().limbs,c=new this._class(1),o=this
;for(r=0;r<n.length;r++)for(s=0;s<this.radix&&(n[r]&1<<s&&(c=c.mulmod(o,e)),r!=n.length-1||n[r]>>s+1!=0);s++)o=o.mulmod(o,e);return c},montpowermod:function(t,e){t=new sjcl.bn(t).normalize().trim(),e=new sjcl.bn(e)
;var i,r,s,n,c,o=this.radix,a=new this._class(1),l=this.copy(),h=t.bitLength();for(s=new sjcl.bn({limbs:e.copy().normalize().trim().limbs.map(function(){return 0})}),n=this.radix;n>0;n--)if(1==(e.limbs[e.limbs.length-1]>>n&1)){s.limbs[s.limbs.length-1]=1<<n
;break}if(0==h)return this;c=h<18?1:h<48?3:h<144?4:h<768?5:6;for(var f=s.copy(),u=e.copy(),d=new sjcl.bn(1),p=new sjcl.bn(0),b=s.copy();b.greaterEquals(1);)b.halveM(),0==(1&d.limbs[0])?(d.halveM(),p.halveM()):(d.addM(u),d.halveM(),p.halveM(),p.addM(f))
;d=d.normalize(),p=p.normalize(),f.doubleM();var m=f.mulmod(f,e);if(!f.mul(d).sub(e.mul(p)).equals(1))return!1;var A=function(t){return B(t,m)},B=function(t,i){var r,c,a,l,h=(1<<n+1)-1;for((a=(c=t.mul(i)).mul(p)).limbs=a.limbs.slice(0,s.limbs.length),
a.limbs.length==s.limbs.length&&(a.limbs[s.limbs.length-1]&=h),a=a.mul(e),(l=c.add(a).normalize().trim()).limbs=l.limbs.slice(s.limbs.length-1),r=0;r<l.limbs.length;r++)r>0&&(l.limbs[r-1]|=(l.limbs[r]&h)<<o-n-1),l.limbs[r]=l.limbs[r]>>n+1
;return l.greaterEquals(e)&&l.subM(e),l};l=A(l),a=A(a);var F,E={},y=(1<<c-1)-1;for(E[1]=l.copy(),E[2]=B(l,l),F=1;F<=y;F++)E[2*F+1]=B(E[2*F-1],E[2]);var g=function(t,e){var i=e%t.radix;return(t.limbs[Math.floor(e/t.radix)]&1<<i)>>i}
;for(i=t.bitLength()-1;i>=0;)if(0==g(t,i))a=B(a,a),i-=1;else{for(var j=i-c+1;0==g(t,j);)j++;var _=0;for(r=j;r<=i;r++)_+=g(t,r)<<r-j,a=B(a,a);a=B(a,E[_]),i=j-1}return function(t){return B(t,1)}(a)},trim:function(){var t,e=this.limbs;do{t=e.pop()
}while(e.length&&0===t);return e.push(t),this},reduce:function(){return this},fullReduce:function(){return this.normalize()},normalize:function(){var t,e,i=0,r=this.placeVal,s=this.ipv,n=this.limbs,c=n.length,o=this.radixMask
;for(t=0;t<c||0!==i&&-1!==i;t++)i=((e=(n[t]||0)+i)-(n[t]=e&o))*s;return-1===i&&(n[t-1]-=r),this.trim(),this},cnormalize:function(){var t,e,i=0,r=this.ipv,s=this.limbs,n=s.length,c=this.radixMask;for(t=0;t<n-1;t++)i=((e=s[t]+i)-(s[t]=e&c))*r;return s[t]+=i,this
},toBits:function(t){this.fullReduce(),t=t||this.exponent||this.bitLength();var e=Math.floor((t-1)/24),i=sjcl.bitArray,r=(t+7&-8)%this.radix||this.radix,s=[i.partial(r,this.getLimb(e))]
;for(e--;e>=0;e--)s=i.concat(s,[i.partial(Math.min(this.radix,t),this.getLimb(e))]),t-=this.radix;return s},bitLength:function(){this.fullReduce();for(var t=this.radix*(this.limbs.length-1),e=this.limbs[this.limbs.length-1];e;e>>>=1)t++;return t+7&-8}},
sjcl.bn.fromBits=function(t){var e=new this,i=[],r=sjcl.bitArray,s=this.prototype,n=Math.min(this.bitLength||4294967296,r.bitLength(t)),c=n%s.radix||s.radix;for(i[0]=r.extract(t,0,c);c<n;c+=s.radix)i.unshift(r.extract(t,c,s.radix));return e.limbs=i,e},
sjcl.bn.prototype.ipv=1/(sjcl.bn.prototype.placeVal=Math.pow(2,sjcl.bn.prototype.radix)),sjcl.bn.prototype.radixMask=(1<<sjcl.bn.prototype.radix)-1,sjcl.bn.pseudoMersennePrime=function(t,e){function i(t){this.initWith(t)}var r,s,n,c=i.prototype=new sjcl.bn
;for(n=c.modOffset=Math.ceil(s=t/c.radix),c.exponent=t,c.offset=[],c.factor=[],c.minOffset=n,c.fullMask=0,c.fullOffset=[],c.fullFactor=[],c.modulus=i.modulus=new sjcl.bn(Math.pow(2,t)),c.fullMask=0|-Math.pow(2,t%c.radix),
r=0;r<e.length;r++)c.offset[r]=Math.floor(e[r][0]/c.radix-s),c.fullOffset[r]=Math.ceil(e[r][0]/c.radix-s),c.factor[r]=e[r][1]*Math.pow(.5,t-e[r][0]+c.offset[r]*c.radix),c.fullFactor[r]=e[r][1]*Math.pow(.5,t-e[r][0]+c.fullOffset[r]*c.radix),
c.modulus.addM(new sjcl.bn(Math.pow(2,e[r][0])*e[r][1])),c.minOffset=Math.min(c.minOffset,-c.offset[r]);return c._class=i,c.modulus.cnormalize(),c.reduce=function(){var t,e,i,r,s=this.modOffset,n=this.limbs,c=this.offset,o=this.offset.length,a=this.factor
;for(t=this.minOffset;n.length>s;){for(i=n.pop(),r=n.length,e=0;e<o;e++)n[r+c[e]]-=a[e]*i;--t||(n.push(0),this.cnormalize(),t=this.minOffset)}return this.cnormalize(),this},c._strongReduce=-1===c.fullMask?c.reduce:function(){var t,e,i=this.limbs,r=i.length-1
;if(this.reduce(),r===this.modOffset-1){for(e=i[r]&this.fullMask,i[r]-=e,t=0;t<this.fullOffset.length;t++)i[r+this.fullOffset[t]]-=this.fullFactor[t]*e;this.normalize()}},c.fullReduce=function(){var t,e;for(this._strongReduce(),this.addM(this.modulus),
this.addM(this.modulus),this.normalize(),this._strongReduce(),e=this.limbs.length;e<this.modOffset;e++)this.limbs[e]=0;for(t=this.greaterEquals(this.modulus),e=0;e<this.limbs.length;e++)this.limbs[e]-=this.modulus.limbs[e]*t;return this.cnormalize(),this},
c.inverse=function(){return this.power(this.modulus.sub(2))},i.fromBits=sjcl.bn.fromBits,i};var sbp=sjcl.bn.pseudoMersennePrime;sjcl.bn.prime={p127:sbp(127,[[0,-1]]),p25519:sbp(255,[[0,-19]]),p192k:sbp(192,[[32,-1],[12,-1],[8,-1],[7,-1],[6,-1],[3,-1],[0,-1]]),
p224k:sbp(224,[[32,-1],[12,-1],[11,-1],[9,-1],[7,-1],[4,-1],[1,-1],[0,-1]]),p256k:sbp(256,[[32,-1],[9,-1],[8,-1],[7,-1],[6,-1],[4,-1],[0,-1]]),p192:sbp(192,[[0,-1],[64,-1]]),p224:sbp(224,[[0,1],[96,-1]]),p256:sbp(256,[[0,-1],[96,1],[192,1],[224,-1]]),
p384:sbp(384,[[0,-1],[32,1],[96,-1],[128,-1]]),p521:sbp(521,[[0,-1]])},sjcl.bn.random=function(t,e){"object"!=typeof t&&(t=new sjcl.bn(t));for(var i,r,s=t.limbs.length,n=t.limbs[s-1]+1,c=new sjcl.bn;;){do{
(i=sjcl.random.randomWords(s,e))[s-1]<0&&(i[s-1]+=4294967296)}while(Math.floor(i[s-1]/n)===Math.floor(4294967296/n));for(i[s-1]%=n,r=0;r<s-1;r++)i[r]&=t.radixMask;if(c.limbs=i,!c.greaterEquals(t))return c}},sjcl.ecc={},sjcl.ecc.point=function(t,e,i){
void 0===e?this.isIdentity=!0:(e instanceof sjcl.bn&&(e=new t.field(e)),i instanceof sjcl.bn&&(i=new t.field(i)),this.x=e,this.y=i,this.isIdentity=!1),this.curve=t},sjcl.ecc.point.prototype={toJac:function(){
return new sjcl.ecc.pointJac(this.curve,this.x,this.y,new this.curve.field(1))},mult:function(t){return this.toJac().mult(t,this).toAffine()},mult2:function(t,e,i){return this.toJac().mult2(t,this,e,i).toAffine()},multiples:function(){var t,e,i
;if(void 0===this._multiples)for(i=this.toJac().doubl(),t=this._multiples=[new sjcl.ecc.point(this.curve),this,i.toAffine()],e=3;e<16;e++)i=i.add(this),t.push(i.toAffine());return this._multiples},negate:function(){
var t=new this.curve.field(0).sub(this.y).normalize().reduce();return new sjcl.ecc.point(this.curve,this.x,t)},isValid:function(){return this.y.square().equals(this.curve.b.add(this.x.mul(this.curve.a.add(this.x.square()))))},toBits:function(){
return sjcl.bitArray.concat(this.x.toBits(),this.y.toBits())}},sjcl.ecc.pointJac=function(t,e,i,r){void 0===e?this.isIdentity=!0:(this.x=e,this.y=i,this.z=r,this.isIdentity=!1),this.curve=t},sjcl.ecc.pointJac.prototype={add:function(t){
var e,i,r,s,n,c,o,a,l,h,f,u=this;if(u.curve!==t.curve)throw new sjcl.exception.invalid("sjcl.ecc.add(): Points must be on the same curve to add them!");return u.isIdentity?t.toJac():t.isIdentity?u:(e=u.z.square(),
(i=t.x.mul(e).subM(u.x)).equals(0)?u.y.equals(t.y.mul(e.mul(u.z)))?u.doubl():new sjcl.ecc.pointJac(u.curve):(r=t.y.mul(e.mul(u.z)).subM(u.y),s=i.square(),n=r.square(),c=i.square().mul(i).addM(u.x.add(u.x).mul(s)),o=n.subM(c),a=u.x.mul(s).subM(o).mul(r),
l=u.y.mul(i.square().mul(i)),h=a.subM(l),f=u.z.mul(i),new sjcl.ecc.pointJac(this.curve,o,h,f)))},doubl:function(){if(this.isIdentity)return this
;var t=this.y.square(),e=t.mul(this.x.mul(4)),i=t.square().mul(8),r=this.z.square(),s=this.curve.a.toString()==new sjcl.bn(-3).toString()?this.x.sub(r).mul(3).mul(this.x.add(r)):this.x.square().mul(3).add(r.square().mul(this.curve.a)),n=s.square().subM(e).subM(e),c=e.sub(n).mul(s).subM(i),o=this.y.add(this.y).mul(this.z)
;return new sjcl.ecc.pointJac(this.curve,n,c,o)},toAffine:function(){if(this.isIdentity||this.z.equals(0))return new sjcl.ecc.point(this.curve);var t=this.z.inverse(),e=t.square()
;return new sjcl.ecc.point(this.curve,this.x.mul(e).fullReduce(),this.y.mul(e.mul(t)).fullReduce())},mult:function(t,e){"number"==typeof t?t=[t]:void 0!==t.limbs&&(t=t.normalize().limbs);var i,r,s=new sjcl.ecc.point(this.curve).toJac(),n=e.multiples()
;for(i=t.length-1;i>=0;i--)for(r=sjcl.bn.prototype.radix-4;r>=0;r-=4)s=s.doubl().doubl().doubl().doubl().add(n[t[i]>>r&15]);return s},mult2:function(t,e,i,r){"number"==typeof t?t=[t]:void 0!==t.limbs&&(t=t.normalize().limbs),
"number"==typeof i?i=[i]:void 0!==i.limbs&&(i=i.normalize().limbs);var s,n,c,o,a=new sjcl.ecc.point(this.curve).toJac(),l=e.multiples(),h=r.multiples();for(s=Math.max(t.length,i.length)-1;s>=0;s--)for(c=0|t[s],o=0|i[s],
n=sjcl.bn.prototype.radix-4;n>=0;n-=4)a=a.doubl().doubl().doubl().doubl().add(l[c>>n&15]).add(h[o>>n&15]);return a},negate:function(){return this.toAffine().negate().toJac()},isValid:function(){var t=this.z.square(),e=t.square(),i=e.mul(t)
;return this.y.square().equals(this.curve.b.mul(i).add(this.x.mul(this.curve.a.mul(e).add(this.x.square()))))}},sjcl.ecc.curve=function(t,e,i,r,s,n){this.field=t,this.r=new sjcl.bn(e),this.a=new t(i),this.b=new t(r),
this.G=new sjcl.ecc.point(this,new t(s),new t(n))},sjcl.ecc.curve.prototype.fromBits=function(t){var e=sjcl.bitArray,i=this.field.prototype.exponent+7&-8,r=new sjcl.ecc.point(this,this.field.fromBits(e.bitSlice(t,0,i)),this.field.fromBits(e.bitSlice(t,i,2*i)))
;if(!r.isValid())throw new sjcl.exception.corrupt("not on the curve!");return r},sjcl.ecc.curves={
c192:new sjcl.ecc.curve(sjcl.bn.prime.p192,"0xffffffffffffffffffffffff99def836146bc9b1b4d22831",-3,"0x64210519e59c80e70fa7e9ab72243049feb8deecc146b9b1","0x188da80eb03090f67cbf20eb43a18800f4ff0afd82ff1012","0x07192b95ffc8da78631011ed6b24cdd573f977a11e794811"),
c224:new sjcl.ecc.curve(sjcl.bn.prime.p224,"0xffffffffffffffffffffffffffff16a2e0b8f03e13dd29455c5c2a3d",-3,"0xb4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4","0xb70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21","0xbd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34"),
c256:new sjcl.ecc.curve(sjcl.bn.prime.p256,"0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551",-3,"0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b","0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296","0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),
c384:new sjcl.ecc.curve(sjcl.bn.prime.p384,"0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973",-3,"0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef","0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7","0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),
c521:new sjcl.ecc.curve(sjcl.bn.prime.p521,"0x1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409",-3,"0x051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","0xC6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","0x11839296A789A3BC0045C8A5FB42C7D1BD998F54449579B446817AFBD17273E662C97EE72995EF42640C550B9013FAD0761353C7086A272C24088BE94769FD16650"),
k192:new sjcl.ecc.curve(sjcl.bn.prime.p192k,"0xfffffffffffffffffffffffe26f2fc170f69466a74defd8d",0,3,"0xdb4ff10ec057e9ae26b07d0280b7f4341da5d1b1eae06c7d","0x9b2f2f6d9c5628a7844163d015be86344082aa88d95e2f9d"),
k224:new sjcl.ecc.curve(sjcl.bn.prime.p224k,"0x010000000000000000000000000001dce8d2ec6184caf0a971769fb1f7",0,5,"0xa1455b334df099df30fc28a169a467e9e47075a90f7e650eb6b7a45c","0x7e089fed7fba344282cafbd6f7e319f7c0b0bd59e2ca4bdb556d61a5"),
k256:new sjcl.ecc.curve(sjcl.bn.prime.p256k,"0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",0,7,"0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},
sjcl.ecc.curveName=function(t){var e;for(e in sjcl.ecc.curves)if(sjcl.ecc.curves.hasOwnProperty(e)&&sjcl.ecc.curves[e]===t)return e;throw new sjcl.exception.invalid("no such curve")},sjcl.ecc.deserialize=function(t){var e=["elGamal","ecdsa"]
;if(!t||!t.curve||!sjcl.ecc.curves[t.curve])throw new sjcl.exception.invalid("invalid serialization");if(-1===e.indexOf(t.type))throw new sjcl.exception.invalid("invalid type");var i=sjcl.ecc.curves[t.curve];if(t.secretKey){
if(!t.exponent)throw new sjcl.exception.invalid("invalid exponent");var r=new sjcl.bn(t.exponent);return new sjcl.ecc[t.type].secretKey(i,r)}if(!t.point)throw new sjcl.exception.invalid("invalid point");var s=i.fromBits(sjcl.codec.hex.toBits(t.point))
;return new sjcl.ecc[t.type].publicKey(i,s)},sjcl.ecc.basicKey={publicKey:function(t,e){this._curve=t,this._curveBitLength=t.r.bitLength(),e instanceof Array?this._point=t.fromBits(e):this._point=e,this.serialize=function(){var e=sjcl.ecc.curveName(t);return{
type:this.getType(),secretKey:!1,point:sjcl.codec.hex.fromBits(this._point.toBits()),curve:e}},this.get=function(){var t=this._point.toBits(),e=sjcl.bitArray.bitLength(t);return{x:sjcl.bitArray.bitSlice(t,0,e/2),y:sjcl.bitArray.bitSlice(t,e/2)}}},
secretKey:function(t,e){this._curve=t,this._curveBitLength=t.r.bitLength(),this._exponent=e,this.serialize=function(){var e=this.get(),i=sjcl.ecc.curveName(t);return{type:this.getType(),secretKey:!0,exponent:sjcl.codec.hex.fromBits(e),curve:i}},
this.get=function(){return this._exponent.toBits()}}},sjcl.ecc.basicKey.generateKeys=function(t){return function(e,i,r){if("number"==typeof(e=e||256)&&void 0===(e=sjcl.ecc.curves["c"+e]))throw new sjcl.exception.invalid("no such curve")
;r=r||sjcl.bn.random(e.r,i);var s=e.G.mult(r);return{pub:new sjcl.ecc[t].publicKey(e,s),sec:new sjcl.ecc[t].secretKey(e,r)}}},sjcl.ecc.elGamal={generateKeys:sjcl.ecc.basicKey.generateKeys("elGamal"),publicKey:function(t,e){
sjcl.ecc.basicKey.publicKey.apply(this,arguments)},secretKey:function(t,e){sjcl.ecc.basicKey.secretKey.apply(this,arguments)}},sjcl.ecc.elGamal.publicKey.prototype={kem:function(t){var e=sjcl.bn.random(this._curve.r,t),i=this._curve.G.mult(e).toBits();return{
key:sjcl.hash.sha256.hash(this._point.mult(e).toBits()),tag:i}},getType:function(){return"elGamal"}},sjcl.ecc.elGamal.secretKey.prototype={unkem:function(t){return sjcl.hash.sha256.hash(this._curve.fromBits(t).mult(this._exponent).toBits())},dh:function(t){
return sjcl.hash.sha256.hash(t._point.mult(this._exponent).toBits())},dhJavaEc:function(t){return t._point.mult(this._exponent).x.toBits()},getType:function(){return"elGamal"}},sjcl.ecc.ecdsa={generateKeys:sjcl.ecc.basicKey.generateKeys("ecdsa")},
sjcl.ecc.ecdsa.publicKey=function(t,e){sjcl.ecc.basicKey.publicKey.apply(this,arguments)},sjcl.ecc.ecdsa.publicKey.prototype={verify:function(t,e,i){sjcl.bitArray.bitLength(t)>this._curveBitLength&&(t=sjcl.bitArray.clamp(t,this._curveBitLength))
;var r=sjcl.bitArray,s=this._curve.r,n=this._curveBitLength,c=sjcl.bn.fromBits(r.bitSlice(e,0,n)),o=sjcl.bn.fromBits(r.bitSlice(e,n,2*n)),a=i?o:o.inverseMod(s),l=sjcl.bn.fromBits(t).mul(a).mod(s),h=c.mul(a).mod(s),f=this._curve.G.mult2(l,h,this._point).x
;if(c.equals(0)||o.equals(0)||c.greaterEquals(s)||o.greaterEquals(s)||!f.equals(c)){if(void 0===i)return this.verify(t,e,!0);throw new sjcl.exception.corrupt("signature didn't check out")}return!0},getType:function(){return"ecdsa"}},
sjcl.ecc.ecdsa.secretKey=function(t,e){sjcl.ecc.basicKey.secretKey.apply(this,arguments)},sjcl.ecc.ecdsa.secretKey.prototype={sign:function(t,e,i,r){sjcl.bitArray.bitLength(t)>this._curveBitLength&&(t=sjcl.bitArray.clamp(t,this._curveBitLength))
;var s=this._curve.r,n=s.bitLength(),c=r||sjcl.bn.random(s.sub(1),e).add(1),o=this._curve.G.mult(c).x.mod(s),a=sjcl.bn.fromBits(t).add(o.mul(this._exponent)),l=i?a.inverseMod(s).mul(c).mod(s):a.mul(c.inverseMod(s)).mod(s)
;return sjcl.bitArray.concat(o.toBits(n),l.toBits(n))},getType:function(){return"ecdsa"}},sjcl.keyexchange.srp={makeVerifier:function(t,e,i,r){var s;return s=sjcl.keyexchange.srp.makeX(t,e,i),s=sjcl.bn.fromBits(s),r.g.powermod(s,r.N)},makeX:function(t,e,i){
var r=sjcl.hash.sha1.hash(t+":"+e);return sjcl.hash.sha1.hash(sjcl.bitArray.concat(i,r))},knownGroup:function(t){return"string"!=typeof t&&(t=t.toString()),sjcl.keyexchange.srp._didInitKnownGroups||sjcl.keyexchange.srp._initKnownGroups(),
sjcl.keyexchange.srp._knownGroups[t]},_didInitKnownGroups:!1,_initKnownGroups:function(){var t,e,i;for(t=0;t<sjcl.keyexchange.srp._knownGroupSizes.length;t++)e=sjcl.keyexchange.srp._knownGroupSizes[t].toString(),
(i=sjcl.keyexchange.srp._knownGroups[e]).N=new sjcl.bn(i.N),i.g=new sjcl.bn(i.g);sjcl.keyexchange.srp._didInitKnownGroups=!0},_knownGroupSizes:[1024,1536,2048,3072,4096,6144,8192],_knownGroups:{1024:{
N:"EEAF0AB9ADB38DD69C33F80AFA8FC5E86072618775FF3C0B9EA2314C9C256576D674DF7496EA81D3383B4813D692C6E0E0D5D8E250B98BE48E495C1D6089DAD15DC7D7B46154D6B6CE8EF4AD69B15D4982559B297BCF1885C529F566660E57EC68EDBC3C05726CC02FD4CBF4976EAA9AFD5138FE8376435B9FC61D2FC0EB06E3",
g:2},1536:{
N:"9DEF3CAFB939277AB1F12A8617A47BBBDBA51DF499AC4C80BEEEA9614B19CC4D5F4F5F556E27CBDE51C6A94BE4607A291558903BA0D0F84380B655BB9A22E8DCDF028A7CEC67F0D08134B1C8B97989149B609E0BE3BAB63D47548381DBC5B1FC764E3F4B53DD9DA1158BFD3E2B9C8CF56EDF019539349627DB2FD53D24B7C48665772E437D6C7F8CE442734AF7CCB7AE837C264AE3A9BEB87F8A2FE9B8B5292E5A021FFF5E91479E8CE7A28C2442C6F315180F93499A234DCF76E3FED135F9BB",
g:2},2048:{
N:"AC6BDB41324A9A9BF166DE5E1389582FAF72B6651987EE07FC3192943DB56050A37329CBB4A099ED8193E0757767A13DD52312AB4B03310DCD7F48A9DA04FD50E8083969EDB767B0CF6095179A163AB3661A05FBD5FAAAE82918A9962F0B93B855F97993EC975EEAA80D740ADBF4FF747359D041D5C33EA71D281E446B14773BCA97B43A23FB801676BD207A436C6481F1D2B9078717461A5B9D32E688F87748544523B524B0D57D5EA77A2775D2ECFA032CFBDBF52FB3786160279004E57AE6AF874E7303CE53299CCC041C7BC308D82A5698F3A8D0C38271AE35F8E9DBFBB694B5C803D89F7AE435DE236D525F54759B65E372FCD68EF20FA7111F9E4AFF73",
g:2},3072:{
N:"FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A93AD2CAFFFFFFFFFFFFFFFF",
g:5},4096:{
N:"FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A92108011A723C12A787E6D788719A10BDBA5B2699C327186AF4E23C1A946834B6150BDA2583E9CA2AD44CE8DBBBC2DB04DE8EF92E8EFC141FBECAA6287C59474E6BC05D99B2964FA090C3A2233BA186515BE7ED1F612970CEE2D7AFB81BDD762170481CD0069127D5B05AA993B4EA988D8FDDC186FFB7DC90A6C08F4DF435C934063199FFFFFFFFFFFFFFFF",
g:5},6144:{
N:"FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A92108011A723C12A787E6D788719A10BDBA5B2699C327186AF4E23C1A946834B6150BDA2583E9CA2AD44CE8DBBBC2DB04DE8EF92E8EFC141FBECAA6287C59474E6BC05D99B2964FA090C3A2233BA186515BE7ED1F612970CEE2D7AFB81BDD762170481CD0069127D5B05AA993B4EA988D8FDDC186FFB7DC90A6C08F4DF435C93402849236C3FAB4D27C7026C1D4DCB2602646DEC9751E763DBA37BDF8FF9406AD9E530EE5DB382F413001AEB06A53ED9027D831179727B0865A8918DA3EDBEBCF9B14ED44CE6CBACED4BB1BDB7F1447E6CC254B332051512BD7AF426FB8F401378CD2BF5983CA01C64B92ECF032EA15D1721D03F482D7CE6E74FEF6D55E702F46980C82B5A84031900B1C9E59E7C97FBEC7E8F323A97A7E36CC88BE0F1D45B7FF585AC54BD407B22B4154AACC8F6D7EBF48E1D814CC5ED20F8037E0A79715EEF29BE32806A1D58BB7C5DA76F550AA3D8A1FBFF0EB19CCB1A313D55CDA56C9EC2EF29632387FE8D76E3C0468043E8F663F4860EE12BF2D5B0B7474D6E694F91E6DCC4024FFFFFFFFFFFFFFFF",
g:5},8192:{
N:"FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A92108011A723C12A787E6D788719A10BDBA5B2699C327186AF4E23C1A946834B6150BDA2583E9CA2AD44CE8DBBBC2DB04DE8EF92E8EFC141FBECAA6287C59474E6BC05D99B2964FA090C3A2233BA186515BE7ED1F612970CEE2D7AFB81BDD762170481CD0069127D5B05AA993B4EA988D8FDDC186FFB7DC90A6C08F4DF435C93402849236C3FAB4D27C7026C1D4DCB2602646DEC9751E763DBA37BDF8FF9406AD9E530EE5DB382F413001AEB06A53ED9027D831179727B0865A8918DA3EDBEBCF9B14ED44CE6CBACED4BB1BDB7F1447E6CC254B332051512BD7AF426FB8F401378CD2BF5983CA01C64B92ECF032EA15D1721D03F482D7CE6E74FEF6D55E702F46980C82B5A84031900B1C9E59E7C97FBEC7E8F323A97A7E36CC88BE0F1D45B7FF585AC54BD407B22B4154AACC8F6D7EBF48E1D814CC5ED20F8037E0A79715EEF29BE32806A1D58BB7C5DA76F550AA3D8A1FBFF0EB19CCB1A313D55CDA56C9EC2EF29632387FE8D76E3C0468043E8F663F4860EE12BF2D5B0B7474D6E694F91E6DBE115974A3926F12FEE5E438777CB6A932DF8CD8BEC4D073B931BA3BC832B68D9DD300741FA7BF8AFC47ED2576F6936BA424663AAB639C5AE4F5683423B4742BF1C978238F16CBE39D652DE3FDB8BEFC848AD922222E04A4037C0713EB57A81A23F0C73473FC646CEA306B4BCBC8862F8385DDFA9D4B7FA2C087E879683303ED5BDD3A062B3CF5B3A278A66D2A13F83F44F82DDF310EE074AB6A364597E899A0255DC164F31CC50846851DF9AB48195DED7EA1B1D510BD7EE74D73FAF36BC31ECFA268359046F4EB879F924009438B481C6CD7889A002ED5EE382BC9190DA6FC026E479558E4475677E9AA9E3050E2765694DFC81F56E880B96E7160C980DD98EDD3DFFFFFFFFFFFFFFFFF",
g:19}}},sjcl.arrayBuffer=sjcl.arrayBuffer||{},"undefined"==typeof ArrayBuffer&&function(t){t.ArrayBuffer=function(){},t.DataView=function(){}}(this),sjcl.arrayBuffer.ccm={mode:"ccm",defaults:{tlen:128},compat_encrypt:function(t,e,i,r,s){
var n,c,o=sjcl.codec.arrayBuffer.fromBits(e,!0,16),a=sjcl.bitArray.bitLength(e)/8;return s=s||64,r=r||[],n=sjcl.arrayBuffer.ccm.encrypt(t,o,i,r,s,a),c=sjcl.codec.arrayBuffer.toBits(n.ciphertext_buffer),c=sjcl.bitArray.clamp(c,8*a),sjcl.bitArray.concat(c,n.tag)
},compat_decrypt:function(t,e,i,r,s){s=s||64,r=r||[];var n=sjcl.bitArray,c=n.bitLength(e),o=n.clamp(e,c-s),a=n.bitSlice(e,c-s),l=sjcl.codec.arrayBuffer.fromBits(o,!0,16),h=sjcl.arrayBuffer.ccm.decrypt(t,l,i,a,r,s,(c-s)/8)
;return sjcl.bitArray.clamp(sjcl.codec.arrayBuffer.toBits(h),c-s)},encrypt:function(t,e,i,r,s,n){var c,o,a=sjcl.bitArray,l=a.bitLength(i)/8;for(r=r||[],s=s||sjcl.arrayBuffer.ccm.defaults.tlen,n=n||e.byteLength,s=Math.ceil(s/8),o=2;o<4&&n>>>8*o;o++);
return o<15-l&&(o=15-l),i=a.clamp(i,8*(15-o)),c=sjcl.arrayBuffer.ccm._computeTag(t,e,i,r,s,n,o),c=sjcl.arrayBuffer.ccm._ctrMode(t,e,i,c,s,o),{ciphertext_buffer:e,tag:c}},decrypt:function(t,e,i,r,s,n,c){var o,a,l,h=sjcl.bitArray,f=h.bitLength(i)/8;for(s=s||[],
n=n||sjcl.arrayBuffer.ccm.defaults.tlen,c=c||e.byteLength,n=Math.ceil(n/8),l=2;l<4&&c>>>8*l;l++);if(l<15-f&&(l=15-f),i=h.clamp(i,8*(15-l)),o=sjcl.arrayBuffer.ccm._ctrMode(t,e,i,r,n,l),a=sjcl.arrayBuffer.ccm._computeTag(t,e,i,s,n,c,l),
!sjcl.bitArray.equal(o,a))throw new sjcl.exception.corrupt("ccm: tag doesn't match");return e},_computeTag:function(t,e,i,r,s,n,c){var o,a,l;sjcl.bitArray;if(a=sjcl.mode.ccm._macAdditionalData(t,r,i,s,n,c),0!==e.byteLength){for(l=new DataView(e),
o=n;o<e.byteLength;o++)l.setUint8(o,0);for(o=0;o<l.byteLength;o+=16)a[0]^=l.getUint32(o),a[1]^=l.getUint32(o+4),a[2]^=l.getUint32(o+8),a[3]^=l.getUint32(o+12),a=t.encrypt(a)}return sjcl.bitArray.clamp(a,8*s)},_ctrMode:function(t,e,i,r,s,n){
var c,o,a,l,h,f,u,d,p=sjcl.bitArray,b=p._xor4,m=e.byteLength/50,A=m;if(o=new DataView(new ArrayBuffer(16)),o=p.concat([p.partial(8,n-1)],i).concat([0,0,0]).slice(0,4),r=p.bitSlice(b(r,t.encrypt(o)),0,8*s),o[3]++,0===o[3]&&o[2]++,
0!==e.byteLength)for(c=new DataView(e),d=0;d<c.byteLength;d+=16)d>m&&(sjcl.mode.ccm._callProgressListener(d/e.byteLength),m+=A),u=t.encrypt(o),a=c.getUint32(d),l=c.getUint32(d+4),h=c.getUint32(d+8),f=c.getUint32(d+12),c.setUint32(d,a^u[0]),
c.setUint32(d+4,l^u[1]),c.setUint32(d+8,h^u[2]),c.setUint32(d+12,f^u[3]),o[3]++,0===o[3]&&o[2]++;return r}},"undefined"==typeof ArrayBuffer&&function(t){t.ArrayBuffer=function(){},t.DataView=function(){}}(this),sjcl.codec.arrayBuffer={fromBits:function(t,e,i){
var r,s,n,c,o;if(e=void 0==e||e,i=i||8,0===t.length)return new ArrayBuffer(0);if(n=sjcl.bitArray.bitLength(t)/8,sjcl.bitArray.bitLength(t)%8!=0)throw new sjcl.exception.invalid("Invalid bit size, must be divisble by 8 to fit in an arraybuffer correctly")
;for(e&&n%i!=0&&(n+=i-n%i),c=new DataView(new ArrayBuffer(4*t.length)),s=0;s<t.length;s++)c.setUint32(4*s,t[s]<<32);if((r=new DataView(new ArrayBuffer(n))).byteLength===c.byteLength)return c.buffer;for(o=c.byteLength<r.byteLength?c.byteLength:r.byteLength,
s=0;s<o;s++)r.setUint8(s,c.getUint8(s));return r.buffer},toBits:function(t){var e,i,r,s=[];if(0===t.byteLength)return[];e=(i=new DataView(t)).byteLength-i.byteLength%4;for(n=0;n<e;n+=4)s.push(i.getUint32(n));if(i.byteLength%4!=0){
r=new DataView(new ArrayBuffer(4));for(var n=0,c=i.byteLength%4;n<c;n++)r.setUint8(n+4-c,i.getUint8(e+n));s.push(sjcl.bitArray.partial(i.byteLength%4*8,r.getUint32(0)))}return s},hexDumpBuffer:function(t){
for(var e=new DataView(t),i="",r=0;r<e.byteLength;r+=2)r%16==0&&(i+="\n"+r.toString(16)+"\t"),i+=function(t,e){return(t+="").length>=e?t:new Array(e-t.length+1).join("0")+t}(e.getUint16(r).toString(16),4)+" ";void 0===typeof console&&(console=console||{
log:function(){}}),console.log(i.toUpperCase())}},function(){function t(t,e,i){return t^e^i}function e(t,e,i){return t&e|~t&i}function i(t,e,i){return(t|~e)^i}function r(t,e,i){return t&i|e&~i}function s(t,e,i){return t^(e|~i)}function n(t,e){
return t<<e|t>>>32-e}function c(t){return(255&t)<<24|(65280&t)<<8|(t&255<<16)>>>8|(t&255<<24)>>>24}function o(c){
for(var o,a=this._h[0],f=this._h[1],u=this._h[2],A=this._h[3],B=this._h[4],F=this._h[0],E=this._h[1],y=this._h[2],g=this._h[3],j=this._h[4],_=0;_<16;++_)o=n(a+t(f,u,A)+c[d[_]]+l[_],b[_])+B,a=B,B=A,A=n(u,10),u=f,f=o,o=n(F+s(E,y,g)+c[p[_]]+h[_],m[_])+j,F=j,j=g,
g=n(y,10),y=E,E=o;for(;_<32;++_)o=n(a+e(f,u,A)+c[d[_]]+l[_],b[_])+B,a=B,B=A,A=n(u,10),u=f,f=o,o=n(F+r(E,y,g)+c[p[_]]+h[_],m[_])+j,F=j,j=g,g=n(y,10),y=E,E=o;for(;_<48;++_)o=n(a+i(f,u,A)+c[d[_]]+l[_],b[_])+B,a=B,B=A,A=n(u,10),u=f,f=o,
o=n(F+i(E,y,g)+c[p[_]]+h[_],m[_])+j,F=j,j=g,g=n(y,10),y=E,E=o;for(;_<64;++_)o=n(a+r(f,u,A)+c[d[_]]+l[_],b[_])+B,a=B,B=A,A=n(u,10),u=f,f=o,o=n(F+e(E,y,g)+c[p[_]]+h[_],m[_])+j,F=j,j=g,g=n(y,10),y=E,E=o;for(;_<80;++_)o=n(a+s(f,u,A)+c[d[_]]+l[_],b[_])+B,a=B,B=A,
A=n(u,10),u=f,f=o,o=n(F+t(E,y,g)+c[p[_]]+h[_],m[_])+j,F=j,j=g,g=n(y,10),y=E,E=o;o=this._h[1]+u+g,this._h[1]=this._h[2]+A+j,this._h[2]=this._h[3]+B+F,this._h[3]=this._h[4]+a+E,this._h[4]=this._h[0]+f+y,this._h[0]=o}sjcl.hash.ripemd160=function(t){
t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},sjcl.hash.ripemd160.hash=function(t){return(new sjcl.hash.ripemd160).update(t).finalize()},sjcl.hash.ripemd160.prototype={reset:function(){return this._h=a.slice(0),
this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t));var e,i=this._buffer=sjcl.bitArray.concat(this._buffer,t),r=this._length,s=this._length=r+sjcl.bitArray.bitLength(t)
;if(s>9007199254740991)throw new sjcl.exception.invalid("Cannot hash more than 2^53 - 1 bits");for(e=512+r-(512+r&511);e<=s;e+=512){for(var n=i.splice(0,16),a=0;a<16;++a)n[a]=c(n[a]);o.call(this,n)}return this},finalize:function(){
var t=sjcl.bitArray.concat(this._buffer,[sjcl.bitArray.partial(1,1)]),e=(this._length+1)%512,i=(e>448?512:448)-e%448,r=i%32;for(r>0&&(t=sjcl.bitArray.concat(t,[sjcl.bitArray.partial(r,0)]));i>=32;i-=32)t.push(0);for(t.push(c(0|this._length)),
t.push(c(Math.floor(this._length/4294967296)));t.length;){for(var s=t.splice(0,16),n=0;n<16;++n)s[n]=c(s[n]);o.call(this,s)}var a=this._h;this.reset();for(n=0;n<5;++n)a[n]=c(a[n]);return a}}
;for(var a=[1732584193,4023233417,2562383102,271733878,3285377520],l=[0,1518500249,1859775393,2400959708,2840853838],h=[1352829926,1548603684,1836072691,2053994217,0],f=4;f>=0;--f)for(var u=1;u<16;++u)l.splice(f,0,l[f]),h.splice(f,0,h[f])
;var d=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],p=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],b=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],m=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]
}(),"undefined"!=typeof module&&module.exports&&(module.exports=sjcl),"function"==typeof define&&define([],function(){return sjcl});